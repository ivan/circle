<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Ellipsis</title>
</head>
<body>
<style>
	html, body {
		background-color: #000;
		margin: 0;
		padding: 0;
		overflow: hidden;
	}

	#canvas {
		image-rendering: pixelated;
	}

	#info {
		color: #0f0;
		text-shadow:
			0 0 2px #000,
			0 0 2px #000,
			0 0 2px #000,
			0 0 2px #000;
		position: absolute;
		top: 4px;
		left: 8px;
		/* Don't catch mouse events intended for the canvas */
		pointer-events: none;
	}
</style>
<div id="info">Info</div>
<canvas id="canvas"></canvas>
<script>
let pixelSize = 8;
let centerX;
let centerY;
let canvas;
let ctx;
let radius;
let info = document.getElementById("info");

// Circle formula:
// x^2 + y^2 = r^2

function draw(coordX, coordY) {
	ctx.fillStyle = "#0f0";
	ctx.fillRect(coordX + centerX, -coordY + centerY, 1, 1);
}

function fill_background() {
	ctx.fillStyle = "#000";
	ctx.fillRect(0, 0, canvas.width, canvas.height);
}

function fill_axes() {
	ctx.fillStyle = "#222";
	ctx.fillRect(centerX, 0, 1, canvas.height);
	ctx.fillRect(0, centerY, canvas.width, 1);
}

function clear() {
	fill_background();
	fill_axes();
}

function resize() {
	canvas.width = Math.ceil(window.innerWidth / pixelSize);
	canvas.height = Math.ceil(window.innerHeight / pixelSize);
	canvas.style.width = `${canvas.width * pixelSize}px`;
	canvas.style.height = `${canvas.height * pixelSize}px`;
	centerX = Math.round(canvas.width / 2);
	centerY = Math.round(canvas.height / 2);
	clear();
}

function draw_circle() {
	draw(0, radius);
	draw(0, -radius);
	draw(radius, 0);
	draw(-radius, 0);
}

function setup() {
	canvas = document.getElementById("canvas");
	ctx = canvas.getContext("2d");
	resize();
	window.onresize = resize;
	canvas.onmousemove = function(ev) {
		const coordX = Math.floor(ev.clientX / pixelSize) - centerX;
		const coordY = -(Math.floor(ev.clientY / pixelSize) - centerY);
		clear();
		radius = Math.floor(Math.sqrt(coordX ** 2 + coordY ** 2));
		draw_circle();
		info.textContent = `(${coordX}, ${coordY}), r = ${radius}`;
	}
}

setup();
</script>
</body>
</html>
